# Git-Based Deployment –¥–ª—è Beget

–ü—Ä–æ—Å—Ç–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ Git-–¥–µ–ø–ª–æ—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∞–π—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ Beget.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

**–ù–∞ GitHub:**
1. –ò–¥–∏—Ç–µ –Ω–∞ https://github.com/new
2. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: `photobooksgallery` 
3. –°–¥–µ–ª–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
4. –ù–∞–∂–º–∏—Ç–µ "Create repository"
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://github.com/username/photobooksgallery.git`)

**–ù–∞ GitLab:**
1. –ò–¥–∏—Ç–µ –Ω–∞ https://gitlab.com/projects/new
2. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

–í PowerShell (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞):
```powershell
# –î–æ–±–∞–≤–ª—è–µ–º remote —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git remote add origin https://github.com/–≤–∞—à-username/photobooksgallery.git

# –ü–µ—Ä–≤—ã–π push (–∑–∞–≥—Ä—É–∂–∞–µ–º –≤–µ—Å—å –ø—Ä–æ–µ–∫—Ç)
git add .
git commit -m "Initial commit - PhotoBooks Gallery project"
git push -u origin main
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–û–î–ò–ù –†–ê–ó)

```bash
# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@82.202.129.237

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–∞–π—Ç–∞
cd /var/www/photobooksgallery

# –î–µ–ª–∞–µ–º –±—ç–∫–∞–ø —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏
tar -czf ../photobooksgallery-backup-$(date +%Y%m%d).tar.gz .

# –û—á–∏—â–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è Git
rm -rf * .* 2>/dev/null || true

# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/–≤–∞—à-username/photobooksgallery.git .

# –î–µ–ª–∞–µ–º deploy —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x deploy-git.sh

# –°–æ–∑–¥–∞—ë–º –ø–∞–ø–∫—É –¥–ª—è –¥–∞–Ω–Ω—ã—Ö (uploads)
mkdir -p /var/www/photobooksgallery-data/uploads
ln -sf /var/www/photobooksgallery-data/uploads uploads

# –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π
bash deploy-git.sh
```

## üì¶ –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∞–π—Ç–∞ –¥–µ–ª–∞–µ—Ç—Å—è –û–î–ù–û–ô –∫–æ–º–∞–Ω–¥–æ–π:

```powershell
# –í PowerShell –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:
./scripts/git-deploy.ps1 -Message "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –±–∞–Ω–Ω–µ—Ä—ã"
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞:
1. ‚úÖ –°–æ–±–µ—Ä—ë—Ç –ø—Ä–æ–µ–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Git  
3. ‚úÖ –°–¥–µ–ª–∞–µ—Ç –∫–æ–º–º–∏—Ç —Å –≤–∞—à–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
4. ‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ GitHub/GitLab
5. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç —Å–µ—Ä–≤–µ—Ä
6. ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
7. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç —á—Ç–æ —Å–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç

## üõ† –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –î–µ–ø–ª–æ–π –±–µ–∑ —Å–±–æ—Ä–∫–∏ (–µ—Å–ª–∏ dist —É–∂–µ –≥–æ—Ç–æ–≤)
```powershell
./scripts/git-deploy.ps1 -SkipBuild -Message "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏"
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π push (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
```powershell
./scripts/git-deploy.ps1 -Force -Message "–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞"
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
ssh root@82.202.129.237 'cd /var/www/photobooksgallery && git log --oneline -5'
```

### –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
```bash
ssh root@82.202.129.237 'cd /var/www/photobooksgallery && git reset --hard HEAD~1 && bash deploy-git.sh'
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
–°–æ–∑–¥–∞–π—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Ñ–∞–π–ª `/var/www/photobooksgallery/.env.production`:
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
nano /var/www/photobooksgallery/.env.production
```

–í —Å–∫—Ä–∏–ø—Ç–µ `deploy-git.sh` –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
# –ü–æ—Å–ª–µ git pull, –¥–æ–±–∞–≤—å—Ç–µ:
if [[ -f ".env.production" ]]; then
    cp .env.production .env
fi
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
photobooksgallery/
‚îú‚îÄ‚îÄ .git/                    # Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îú‚îÄ‚îÄ .gitignore              # –ò—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ Git
‚îú‚îÄ‚îÄ deploy-git.sh           # –°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ git-deploy.ps1      # –ö–æ–º–∞–Ω–¥–∞ –¥–µ–ø–ª–æ—è —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã
‚îú‚îÄ‚îÄ client/                 # Frontend –∫–æ–¥
‚îú‚îÄ‚îÄ server/                 # Backend –∫–æ–¥
‚îú‚îÄ‚îÄ migrations/             # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ uploads -> /var/www/photobooksgallery-data/uploads  # Symlink
‚îî‚îÄ‚îÄ backups/               # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
```

## ‚ùó –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –ß—Ç–æ –ù–ï –ø–æ–ø–∞–¥–∞–µ—Ç –≤ Git
- `node_modules/` ‚Äî –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- `dist/` ‚Äî –±—É–¥–µ—Ç —Å–æ–±—Ä–∞–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- `.env` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `uploads/` ‚Äî —Ñ–∞–π–ª—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –ª–æ–≥–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- `.env` —Ñ–∞–π–ª—ã –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ Git
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
–ü–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å–æ–∑–¥–∞—ë—Ç—Å—è –±—ç–∫–∞–ø –≤ `/var/www/photobooksgallery/backups/`

## üÜò –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

### –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞
cd /var/www/photobooksgallery/backups
tar -xzf backup_YYYYMMDD_HHMMSS.tar.gz -C ../
pm2 restart photobooksgallery
```

### –õ–æ–≥–∏ –¥–µ–ø–ª–æ—è
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –¥–µ–ø–ª–æ—è
tail -f /var/www/photobooksgallery/deploy.log
```

### PM2 –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
pm2 logs photobooksgallery --lines 50
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Git-–¥–µ–ø–ª–æ—è

‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã  
‚úÖ **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ**: –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π  
‚úÖ **–û—Ç–∫–∞—Ç**: –õ–µ–≥–∫–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏  
‚úÖ **–ß–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å**: –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã  
‚úÖ **–°–∫–æ—Ä–æ—Å—Ç—å**: –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Git  

---

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π Git-based –¥–µ–ø–ª–æ–π. üöÄ