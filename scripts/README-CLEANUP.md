# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ Docker –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ

## –ß—Ç–æ —ç—Ç–æ?

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –º—É—Å–æ—Ä–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ.

## –ü—Ä–æ–±–ª–µ–º–∞

–°–æ –≤—Ä–µ–º–µ–Ω–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è:
- –°—Ç–∞—Ä—ã–µ Docker –æ–±—Ä–∞–∑—ã (2-3 GB)
- Build cache (6+ GB)
- –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- –°—Ç–∞—Ä—ã–µ –ª–æ–≥–∏
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–µ–ø–ª–æ—è
- APT –∫—ç—à

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¥–∏—Å–∫ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–æ 15 GB –≤–º–µ—Å—Ç–æ 4-5 GB.

## –†–µ—à–µ–Ω–∏–µ

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ 3:00 –Ω–æ—á–∏.

## –§–∞–π–ª—ã

### `cleanup-docker.sh`
–û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏. –í—ã–ø–æ–ª–Ω—è–µ—Ç:
1. –£–¥–∞–ª—è–µ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Docker –æ–±—Ä–∞–∑—ã, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, volumes
2. –û—á–∏—â–∞–µ—Ç build cache
3. –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ (>7 –¥–Ω–µ–π)
4. –£–¥–∞–ª—è–µ—Ç –∞—Ä—Ö–∏–≤—ã –¥–µ–ø–ª–æ—è (>1 –¥–Ω—è)
5. –û—á–∏—â–∞–µ—Ç temp —Ñ–∞–π–ª—ã (>3 –¥–Ω–µ–π)
6. –û—á–∏—â–∞–µ—Ç APT –∫—ç—à

### `install-cleanup.sh`
–°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏. –í—ã–ø–æ–ª–Ω—è–µ—Ç:
1. –ö–æ–ø–∏—Ä—É–µ—Ç `cleanup-docker.sh` –≤ `/opt/`
2. –°–æ–∑–¥–∞—ë—Ç –ª–æ–≥-—Ñ–∞–π–ª
3. –î–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á—É –≤ crontab
4. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—É—é –æ—á–∏—Å—Ç–∫—É

### `cron-cleanup.txt`
–ü—Ä–∏–º–µ—Ä cron-–∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –¥–µ–ø–ª–æ–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É **"üì§ –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä"** —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!

–°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è:
1. –ó–∞–≥—Ä—É–∑–∏—Ç —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
2. –ó–∞–ø—É—Å—Ç–∏—Ç `install-cleanup.sh`
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç cron
4. –í—ã–ø–æ–ª–Ω–∏—Ç –ø–µ—Ä–≤—É—é –æ—á–∏—Å—Ç–∫—É

### –†—É—á–Ω–∞—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –≤—ã–ø–æ–ª–Ω–∏:

```bash
ssh root@46.173.29.247
cd /opt/photobooksgallery/scripts
bash install-cleanup.sh
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ cron –Ω–∞—Å—Ç—Ä–æ–µ–Ω

```bash
ssh root@46.173.29.247 "crontab -l"
```

–î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞:
```
0 3 * * 0 /opt/cleanup-docker.sh >> /var/log/docker-cleanup.log 2>&1
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏

```bash
ssh root@46.173.29.247 "tail -50 /var/log/docker-cleanup.log"
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é

```bash
ssh root@46.173.29.247 "/opt/cleanup-docker.sh"
```

## –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ

- **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:** –ö–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ 3:00 –Ω–æ—á–∏
- **–ï–∂–µ–º–µ—Å—è—á–Ω–æ:** 1-–≥–æ —á–∏—Å–ª–∞ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ –≤ 2:00 –Ω–æ—á–∏ (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –≥–ª—É–±–æ–∫–∞—è –æ—á–∏—Å—Ç–∫–∞)

## –ß—Ç–æ —É–¥–∞–ª—è–µ—Ç—Å—è

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ —É–¥–∞–ª—è–µ—Ç—Å—è:**
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Docker –æ–±—Ä–∞–∑—ã
- –°—Ç–∞—Ä—ã–µ —Å–ª–æ–∏ build cache
- –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ volumes
- –õ–æ–≥–∏ —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
- –ê—Ä—Ö–∏–≤—ã –¥–µ–ø–ª–æ—è —Å—Ç–∞—Ä—à–µ 1 –¥–Ω—è
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Å—Ç–∞—Ä—à–µ 3 –¥–Ω–µ–π
- APT –∫—ç—à

‚ùå **–ù–ï —É–¥–∞–ª—è–µ—Ç—Å—è:**
- –†–∞–±–æ—Ç–∞—é—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- –ê–∫—Ç–∏–≤–Ω—ã–µ –æ–±—Ä–∞–∑—ã
- –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ volumes
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏ (–¥–æ 7 –¥–Ω–µ–π)

## –†–µ–∑—É–ª—å—Ç–∞—Ç

**–î–æ –æ—á–∏—Å—Ç–∫–∏:** 14-15 GB –∑–∞–Ω—è—Ç–æ  
**–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏:** 4-5 GB –∑–∞–Ω—è—Ç–æ  
**–û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è:** ~10 GB –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞

```bash
ssh root@46.173.29.247 "df -h /"
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Docker —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

```bash
ssh root@46.173.29.247 "docker system df"
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—á–∏—Å—Ç–∫–∏

```bash
ssh root@46.173.29.247 "tail -100 /var/log/docker-cleanup.log"
```

## –û—Ç–∫–ª—é—á–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ß—Ç–æ–±—ã –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É:

```bash
ssh root@46.173.29.247
crontab -e
# –£–¥–∞–ª–∏ –∏–ª–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π —Å—Ç—Ä–æ–∫—É —Å cleanup-docker.sh
```

## –í–∞–∂–Ω–æ

- –û—á–∏—Å—Ç–∫–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–æ—á—å—é (3:00 AM) —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å —Ä–∞–±–æ—Ç–µ —Å–∞–π—Ç–∞
- –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `/var/log/docker-cleanup.log`
- –†–∞–±–æ—Ç–∞—é—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã **–ù–ï** –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è
- –ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ —Å–∞–π—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤

---

**–°–æ–∑–¥–∞–Ω–æ:** 6 –Ω–æ—è–±—Ä—è 2025  
**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é ‚úÖ
