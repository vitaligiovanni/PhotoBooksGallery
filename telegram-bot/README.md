# Telegram Bot –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–µ—Ä–≤–µ—Ä–∞

–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π Telegram-–±–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–º photobooksgallery.am.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîî –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **–î–∏—Å–∫**: –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ > 70% (–∫–∞–∂–¥—ã–π —á–∞—Å)
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã**: –∞–ª–µ—Ä—Ç –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ (–∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç)
- **–õ–æ–≥–∏**: –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö (–∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç)
- **–ë—ç–∫–∞–ø—ã**: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤ (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ 10:00)

### üéõÔ∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é (`/menu`)
- üíæ **–°—Ç–∞—Ç—É—Å –¥–∏—Å–∫–∞** ‚Äî —Ç–µ–∫—É—â–∞—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏
- üì¶ **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** ‚Äî health-—Å—Ç–∞—Ç—É—Å, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫, –ª–æ–≥–∏
- üóëÔ∏è **–°—Ç–∞—Ä—ã–µ –±—ç–∫–∞–ø—ã** ‚Äî —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ >30 –¥–Ω–µ–π
- üßπ **–û—á–∏—Å—Ç–∏—Ç—å Docker** ‚Äî prune –æ–±—Ä–∞–∑–æ–≤ –∏ –∫–µ—à–∞
- üìã **–õ–æ–≥–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä backend/ar-service/frontend

### üì± –ö–æ–º–∞–Ω–¥—ã
```
/start       ‚Äî –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ
/menu        ‚Äî –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
/status      ‚Äî –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
/disk        ‚Äî –î–µ—Ç–∞–ª–∏ –¥–∏—Å–∫–∞
/containers  ‚Äî –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
/backups     ‚Äî –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –±—ç–∫–∞–ø—ã
/logs [name] ‚Äî –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather)
2. –ü–æ–ª—É—á–∏—Ç–µ `TELEGRAM_TOKEN` –∏ –≤–∞—à `TELEGRAM_CHAT_ID`
3. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```env
TELEGRAM_TOKEN=123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11
TELEGRAM_CHAT_ID=959125046
```

4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
cd telegram-bot
npm install
npm run dev    # development —Å hot-reload
npm start      # production
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ production

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ systemd
```bash
# /etc/systemd/system/telegram-bot.service
[Unit]
Description=Telegram Bot for Server Monitoring
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/root/photobooksgallery/telegram-bot
ExecStart=/usr/bin/node /root/photobooksgallery/telegram-bot/dist/index.js
Restart=always
RestartSec=10
Environment=NODE_ENV=production

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl enable telegram-bot
sudo systemctl start telegram-bot
sudo systemctl status telegram-bot
```

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker
–î–æ–±–∞–≤—å—Ç–µ –≤ `docker-compose.yml`:
```yaml
telegram-bot:
  build:
    context: ./telegram-bot
  restart: unless-stopped
  env_file: .env
  volumes:
    - /var/run/docker.sock:/var/run/docker.sock:ro
    - ./backups:/root/backups:ro
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
telegram-bot/
‚îú‚îÄ‚îÄ index.ts              # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îú‚îÄ‚îÄ disk-monitor.ts       # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∏—Å–∫–∞
‚îú‚îÄ‚îÄ container-health.ts   # –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker
‚îú‚îÄ‚îÄ backup-cleaner.ts     # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—ç–∫–∞–ø–∞–º–∏
‚îú‚îÄ‚îÄ interactive-menu.ts   # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îî‚îÄ‚îÄ README.md
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –≤–∞—à–∏–º `TELEGRAM_CHAT_ID`
- –í—Å–µ –∫–æ–º–∞–Ω–¥—ã —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –î–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Ç—Ä–µ–±—É—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## –ü—Ä–∏–º–µ—Ä—ã –∞–ª–µ—Ä—Ç–æ–≤

### –î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω >80%
```
üî¥ –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï –û –î–ò–°–ö–ï

üíæ –í—Å–µ–≥–æ: 30GB
üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: 25GB (83%)
‚úÖ –°–≤–æ–±–æ–¥–Ω–æ: 5GB

‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –ú–∞–ª–æ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞!

üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
‚Ä¢ üê≥ –û—á–∏—Å—Ç–∏—Ç—å Docker (~2-5GB)
‚Ä¢ üìã –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ (~0.5-2GB)
‚Ä¢ üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –±—ç–∫–∞–ø—ã (~1-10GB)

üîß –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /menu –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –æ—á–∏—Å—Ç–∫–∏
```

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —É–ø–∞–ª
```
üö® –ö–†–ò–¢–ò–ß–ù–û: –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏!

‚ùå backend
   Status: exited
   Health: unhealthy
   Uptime: Exited (1) 2 minutes ago

üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: docker logs backend
‚Ä¢ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ: docker restart backend
‚Ä¢ –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ: docker compose up -d --build
```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. `TELEGRAM_TOKEN` –∏ `TELEGRAM_CHAT_ID` –≤ `.env`
2. –ë–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —á–∞—Ç –∏ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
3. Docker socket –¥–æ—Å—Ç—É–ø–µ–Ω (`/var/run/docker.sock`)
4. –ü—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ `/root/backups`
